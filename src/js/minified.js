function edit_page(a){var b={id:$("#id").val(),title:$("#title").val(),description:$("#description").val(),type:$("#type").val(),isActive:$("#is_active").prop("checked"),publishedOn:$("#published_on").val()};b=JSON.stringify(b),$.ajax({type:"PUT",contentType:"application/json",url:"http://pagesmanagement.azurewebsites.net/api/ResponsivePages/"+a,data:b,dataType:"json",complete:function(){$.ambiance({message:"Page edited successfully",title:"Success!",type:"success"}),show_list_pages()}})}function create_new_page(){($(".error").is(":visible")||!$("#id").val()&&!$("#title").val()&&!$("#published_on").val())&&$("#create_page").removeAttr("disabled");var a={id:$("#id").val(),title:$("#title").val(),description:$("#description").val(),type:$("#type").val(),isActive:$("#is_active").prop("checked"),publishedOn:$("#published_on").val()};a=JSON.stringify(a),$.ajax({type:"POST",contentType:"application/json",url:"http://pagesmanagement.azurewebsites.net/api/ResponsivePages",data:a,dataType:"json",success:function(a){a.id?$.ambiance({message:"Page added successufully",title:"Success!",type:"success"}):$.ambiance({message:"An error occured. Please try again",type:"error",title:"Error!"}),show_list_pages()}})}function delete_page(a){open_modal({message:"<p>Are you sure you want to delete this page?</p>",confirm:1,callback:function(){$.ajax({type:"DELETE",contentType:"application/json",url:"http://pagesmanagement.azurewebsites.net/api/ResponsivePages/"+a,dataType:"json",success:function(a){a.id?$.ambiance({message:"Page deleted successufully",title:"Success!",type:"success"}):$.ambiance({message:"An error occured. Please try again",type:"error",title:"Error!"}),show_list_pages()}})}})}function show_landing_page(){var a=$("#landing_page_template").html(),b=Handlebars.compile(a);$("#content").html(b)}function show_list_pages(){show_overlay();var a=$("#list_pages_template").html(),b=Handlebars.compile(a);$.ajax({type:"GET",contentType:"application/json",url:"http://pagesmanagement.azurewebsites.net/api/ResponsivePages",dataType:"json",success:function(a){hide_overlay(),$("#create_page").removeAttr("disabled"),a={pages:a};var c=b(a);$("#content").html(c),$(".delete").on("click",function(){var a=$(this).closest("tr").find(".page_id").html();delete_page(a)}),$(".edit").on("click",function(){var a=$(this).closest("tr").find(".page_id").html();show_edit_page(a)}),$(window).trigger("redraw")}})}function show_create_page(){var a=$("#create_page_template").html(),b=Handlebars.compile(a),c=b({is_edit:0});$("#content").html(c),$("#create_page").on("click",function(a){$("#create_page").attr("disabled","disabled"),create_new_page()}),$(".hasdatepicker").datetimepicker({timeFormat:"'T'HH:mm:ss",dateFormat:"yy-mm-dd",separator:""}),$(document).foundation()}function show_edit_page(a){var b=$("#create_page_template").html(),c=Handlebars.compile(b);$.ajax({type:"GET",contentType:"application/json",url:"http://pagesmanagement.azurewebsites.net/api/ResponsivePages/"+a,dataType:"json",success:function(b){if(b.id){b.is_edit=1;var d=c(b);$("#content").html(d),$(".hasdatepicker").datetimepicker({timeFormat:"'T'HH:mm:ss",dateFormat:"yy-mm-dd",separator:""}),$("#create_page").on("click",function(b){b.preventDefault(),edit_page(a)}),$(document).foundation()}},error:function(){$.ambiance({message:"No page was found with id "+a,type:"error",title:"Error!"})}})}function open_modal(a){$("#myModal").html(a.message),1==a.confirm&&($("#myModal").append('<button class="confirm small"><i class="fa fa-check"></i>Confirm</button>'),$("#myModal").append('<button class="cancel small"><i class="fa fa-times"></i>Cancel</button>')),$("#myModal").foundation("reveal","open"),$(".cancel").on("click",function(){$("#myModal").foundation("reveal","close")}),$(".confirm").on("click",function(){$("#myModal").foundation("reveal","close"),a.callback()})}function show_overlay(){$(".loading-overlay").show(),$(".loading-info").css("position","absolute"),$(".loading-info").css("top","30%"),$(".loading-info").css("left",Math.max(0,($(window).width()-$(".loading-info").outerWidth())/2+$(window).scrollLeft())+"px"),$(".loading-info").show()}function hide_overlay(){$(".loading-overlay").hide(),$(".loading-info").hide()}Handlebars.registerHelper("equals",function(a,b,c){return a==b?c.fn(this):c.inverse(this)}),$(document).ready(function(){var a=Sammy("body",function(){this.get("#landing_page/",function(){show_landing_page()}),this.get("#list_pages/",function(){show_list_pages()}),this.get("#create_page/",function(){show_create_page()}),this.get("#edit_page/:page_id/",function(){show_edit_page(this.params.page_id)}),this.notFound=function(){}});a.run("#landing_page/")});